<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>react-intl 实现 React 国际化多语言 | 方雨_Yu的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="react-intl 实现 React 国际化多语言">
<meta property="og:type" content="article">
<meta property="og:title" content="react-intl 实现 React 国际化多语言">
<meta property="og:url" content="http://sufangyu.github.io/2017/12/03/react-intl-实现-React-国际化多语言/index.html">
<meta property="og:site_name" content="方雨_Yu的博客">
<meta property="og:description" content="react-intl 实现 React 国际化多语言">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2017/11/1/63d8956690c2a051a1f87628afad7ceb">
<meta property="og:updated_time" content="2018-03-26T04:55:20.954Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="react-intl 实现 React 国际化多语言">
<meta name="twitter:description" content="react-intl 实现 React 国际化多语言">
  
    <link rel="alternative" href="/atom.xml" title="方雨_Yu的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
  <link rel="stylesheet" href="/css/owl.carousel.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars0.githubusercontent.com/u/1852629?v=3&amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">方雨_Yu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">关注前端开发，爱生活！</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/categories/前端">前端</a></li>
				        
							<li><a href="/work">作品</a></li>
				        
							<li><a href="/about">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/sufangyu" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://www.weibo.com" title="weibo">weibo</a>
					        
								<a class="zcool" target="_blank" href="http://fangyu.zcool.com.cn" title="zcool">zcool</a>
					        
								<a class="mail" target="_blank" href="mailto:304683191@qq.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CSS/" style="font-size: 14px;">CSS</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/Dialog/" style="font-size: 12px;">Dialog</a> <a href="/tags/HTML/" style="font-size: 14px;">HTML</a> <a href="/tags/JavaScript/" style="font-size: 12px;">JavaScript</a> <a href="/tags/Material-Design/" style="font-size: 10px;">Material Design</a> <a href="/tags/Zepto/" style="font-size: 16px;">Zepto</a> <a href="/tags/infinite-list/" style="font-size: 10px;">infinite-list</a> <a href="/tags/jQuery/" style="font-size: 18px;">jQuery</a> <a href="/tags/label/" style="font-size: 10px;">label</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/react-intl/" style="font-size: 10px;">react-intl</a> <a href="/tags/rem/" style="font-size: 10px;">rem</a> <a href="/tags/下拉列表/" style="font-size: 10px;">下拉列表</a> <a href="/tags/前端/" style="font-size: 20px;">前端</a> <a href="/tags/响应式/" style="font-size: 10px;">响应式</a> <a href="/tags/国际化/" style="font-size: 10px;">国际化</a> <a href="/tags/多语言/" style="font-size: 10px;">多语言</a> <a href="/tags/弹窗/" style="font-size: 10px;">弹窗</a> <a href="/tags/无限加载/" style="font-size: 10px;">无限加载</a> <a href="/tags/水波纹/" style="font-size: 10px;">水波纹</a> <a href="/tags/移动端/" style="font-size: 12px;">移动端</a> <a href="/tags/表单/" style="font-size: 10px;">表单</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">方雨_Yu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars0.githubusercontent.com/u/1852629?v=3&amp;s=460" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">方雨_Yu</h1>
			</hgroup>
			
			<p class="header-subtitle">关注前端开发，爱生活！</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/categories/前端">前端</a></li>
		        
					<li><a href="/work">作品</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/sufangyu" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://www.weibo.com" title="weibo">weibo</a>
			        
						<a class="zcool" target="_blank" href="http://fangyu.zcool.com.cn" title="zcool">zcool</a>
			        
						<a class="mail" target="_blank" href="mailto:304683191@qq.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-react-intl-实现-React-国际化多语言" class="article article-type-post" itemscope itemprop="blogPost">
  
    
	
  <div class="article-inner">
	
	
		<div class="article-meta">
		  <a href="/2017/12/03/react-intl-实现-React-国际化多语言/" class="article-date">
  	<time datetime="2017-12-03T02:57:09.000Z" itemprop="datePublished">2017-12-03</time>
</a>
		</div>
	  
  
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      react-intl 实现 React 国际化多语言
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-intl/">react-intl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/国际化/">国际化</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/多语言/">多语言</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/前端/">前端</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
	
	
		
    <div class="article-entry" itemprop="articleBody">
      
        <p>React 做国际化，我推荐使用 React-intl , 这个库提供了 React 组件和Api两种方式来格式化日期，数字和字符串等。知道这个库了，那让我们开始使用它</p>
<h2 id="u6548_u679C_u9884_u89C8"><a href="#u6548_u679C_u9884_u89C8" class="headerlink" title="效果预览"></a>效果预览</h2><p><img src="https://user-gold-cdn.xitu.io/2017/11/1/63d8956690c2a051a1f87628afad7ceb" alt=""></p>
<a id="more"></a>
<h2 id="React_Intl__u56FD_u9645_u5316_u6B65_u9AA4"><a href="#React_Intl__u56FD_u9645_u5316_u6B65_u9AA4" class="headerlink" title="React Intl 国际化步骤"></a>React Intl 国际化步骤</h2><ol>
<li>创建国际化资源文件</li>
<li>根据语言获取国际化资源</li>
<li>引入 react-intl 的 local data</li>
<li>创建 LocaleProvider 国际化上下文组件</li>
<li>创建 react-intl 国际化上下文组件</li>
<li>使用 react-intl’s components &amp; apis，进行国际化开发</li>
</ol>
<h3 id="1-__u521B_u5EFA_u56FD_u9645_u5316_u8D44_u6E90_u6587_u4EF6"><a href="#1-__u521B_u5EFA_u56FD_u9645_u5316_u8D44_u6E90_u6587_u4EF6" class="headerlink" title="1. 创建国际化资源文件"></a>1. 创建国际化资源文件</h3><p>目前我们管理资源文件的方式是在 src/locales 文件夹下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── en-US<span class="class">.js</span></span><br><span class="line">├── en-US<span class="class">.messages</span><span class="class">.js</span></span><br><span class="line">├── zh-Hans<span class="class">.js</span></span><br><span class="line">└── zh-Hans<span class="class">.messages</span><span class="class">.js</span></span><br></pre></td></tr></table></figure>
<p>*.messages.js 是我们的资源文件(这里我们采用了 js 格式，你也可以使用 json 等等)，返回的是一个对象，key 为我们翻译用的 id，value 为具体语言的翻译，内容是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="string">'page.localeProvider.react'</span>: <span class="string">'&#123; name &#125;, a JavaScript library for building user interfaces.'</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.react.html'</span>: <span class="string">'&lt;p&gt;&#123; name &#125; makes it painless to create interactive UIs. Design simple views for each state in your application, and &#123; name &#125; will efficiently update and render just the right components when your data changes.&lt;/p&gt;&lt;p&gt;Declarative views make your code more predictable and easier to debug.&lt;/p&gt;'</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.unreadCount'</span>: <span class="string">'You have &#123;unreadCount&#125; new &#123;notifications&#125;'</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.date'</span>: <span class="string">'Current date: '</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.time'</span>: <span class="string">'Current time: '</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.relative'</span>: <span class="string">'Relative current time: '</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.number'</span>: <span class="string">'Comma number: '</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.price'</span>: <span class="string">'Price: '</span>,</span><br><span class="line">  <span class="string">'page.localeProvider.title.percent'</span>: <span class="string">'Percent: '</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>en-US.js 文件封装了 messages、locale 等国际化上下文组件需要的内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appLocaleData <span class="keyword">from</span> <span class="string">'react-intl/locale-data/en'</span>;</span><br><span class="line"><span class="comment">// 引入组件多语言</span></span><br><span class="line"><span class="keyword">import</span> paginationLocale <span class="keyword">from</span> <span class="string">'@/components/pagination/locales/en-US'</span>;</span><br><span class="line"><span class="keyword">import</span> messages <span class="keyword">from</span> <span class="string">'./en-US.messages'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.appLocale = &#123;</span><br><span class="line">  <span class="comment">// 合并所有 messages, 加入组件的 messages</span></span><br><span class="line">  messages: <span class="built_in">Object</span>.assign(&#123;&#125;, messages, &#123;</span><br><span class="line">    Pagination: paginationLocale,</span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// locale</span></span><br><span class="line">  locale: <span class="string">'en-US'</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// react-intl locale-data</span></span><br><span class="line">  data: appLocaleData,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义 formates</span></span><br><span class="line">  formats: &#123;</span><br><span class="line">    date: &#123;</span><br><span class="line">      normal: &#123;</span><br><span class="line">        hour12: <span class="literal">false</span>,</span><br><span class="line">        year: <span class="string">'numeric'</span>,</span><br><span class="line">        month: <span class="string">'2-digit'</span>,</span><br><span class="line">        day: <span class="string">'2-digit'</span>,</span><br><span class="line">        hour: <span class="string">'2-digit'</span>,</span><br><span class="line">        minute: <span class="string">'2-digit'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 货币</span></span><br><span class="line">    money: &#123;</span><br><span class="line">      currency: <span class="string">'USD'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">window</span>.appLocale;</span><br></pre></td></tr></table></figure>
<p>有了这些资源文件以及相关的封装之后，我们就可以在 <code>LocaleProvider</code> 和 <code>InltProvider</code> 中使用了。</p>
<h3 id="2-__u6839_u636E_u8BED_u8A00_u52A0_u8F7D_u56FD_u9645_u5316_u8D44_u6E90"><a href="#2-__u6839_u636E_u8BED_u8A00_u52A0_u8F7D_u56FD_u9645_u5316_u8D44_u6E90" class="headerlink" title="2. 根据语言加载国际化资源"></a>2. 根据语言加载国际化资源</h3><p>上一步我们创建了不同语言版本的国际化资源文件，我们还需要一个函数能够根据语言，加载对应的资源文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 获取国际化资源文件</span><br><span class="line"> *</span><br><span class="line"> * @param &#123;any&#125; lang</span><br><span class="line"> * @returns</span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLocale</span>(<span class="params">lang</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line">  <span class="keyword">switch</span> (lang) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'zh-CN'</span>:</span><br><span class="line">      result = <span class="built_in">require</span>(<span class="string">'./locales/zh-Hans'</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'en-US'</span>:</span><br><span class="line">      result = <span class="built_in">require</span>(<span class="string">'./locales/en-US'</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      result = <span class="built_in">require</span>(<span class="string">'./locales/zh-Hans'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result.default || result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-__u5F15_u5165_react-intl__u7684_local_data"><a href="#3-__u5F15_u5165_react-intl__u7684_local_data" class="headerlink" title="3. 引入 react-intl 的 local data"></a>3. 引入 react-intl 的 local data</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; addLocaleData &#125; <span class="keyword">from</span> <span class="string">'react-intl'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> appLocale = getLocale(<span class="string">'en-US'</span>);</span><br><span class="line">  addLocaleData(...appLocale.data);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>react-intl 在做国际化的时候需要一些特有的 local data，主要是进行相对时间翻译时，比如昨天、今天、明天、几分钟前、几个月前之类的。<br>我们通过 <code>addLocaleData</code> 这个方法加载相关内容，大家可以根据实际情况加载需要的 locale-data。</p>
<h3 id="4-__u521B_u5EFA_LocaleProvider__u56FD_u9645_u5316_u4E0A_u4E0B_u6587_u7EC4_u4EF6"><a href="#4-__u521B_u5EFA_LocaleProvider__u56FD_u9645_u5316_u4E0A_u4E0B_u6587_u7EC4_u4EF6" class="headerlink" title="4. 创建 LocaleProvider 国际化上下文组件"></a>4. 创建 LocaleProvider 国际化上下文组件</h3><p>为了组件能够国际化资源信息，我们需要一个 LocaleProvider 组件，用它来提供国际化的上下文，具体用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">LocaleProvider</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  static propTypes = &#123;</span><br><span class="line">    children: PropTypes.any,</span><br><span class="line">    locale: PropTypes.object,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  static childContextTypes = &#123;</span><br><span class="line">    <span class="comment">// 语言信息</span></span><br><span class="line">    locale: PropTypes.object,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  getChildContext() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      locale: &#123;</span><br><span class="line">        ...this.props.locale,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> React.Children.only(<span class="keyword">this</span>.props.children);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-__u521B_u5EFA_react-intl__u56FD_u9645_u5316_u4E0A_u4E0B_u6587_u7EC4_u4EF6"><a href="#5-__u521B_u5EFA_react-intl__u56FD_u9645_u5316_u4E0A_u4E0B_u6587_u7EC4_u4EF6" class="headerlink" title="5. 创建 react-intl 国际化上下文组件"></a>5. 创建 react-intl 国际化上下文组件</h3><p>为了能够使用 react-intl 进行国际化，跟 redux 这些框架一样，我们需要一个 Provider Component，用它来提供国际化的上下文，具体用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> &#123; addLocaleData, IntlProvider &#125; <span class="keyword">from</span> <span class="string">'react-intl'</span>;</span><br><span class="line"><span class="keyword">import</span> LocaleProvider <span class="keyword">from</span> <span class="string">'@/components/locale-provider'</span>;</span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'@/views/home'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="comment">// 根据语言获取国际化资源</span></span><br><span class="line">  <span class="keyword">const</span> appLocale = getLocale(<span class="string">'en-US'</span>);</span><br><span class="line">  addLocaleData(...appLocale.data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="title">LocaleProvider</span> <span class="attribute">locale</span>=<span class="value">&#123;appLocale&#125;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">IntlProvider</span></span><br><span class="line">        <span class="attribute">locale</span>=<span class="value">&#123;appLocale.locale&#125;</span></span><br><span class="line">        <span class="attribute">messages</span>=<span class="value">&#123;appLocale.messages&#125;</span></span><br><span class="line">        <span class="attribute">formats</span>=<span class="value">&#123;appLocale.formats&#125;</span></span><br><span class="line">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">Home</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">IntlProvider</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LocaleProvider</span>&gt;</span></span><br><span class="line">  )</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LocaleProvider 有三个配置参数：</span><br><span class="line">  locale, <span class="xml"><span class="tag">&lt;<span class="title">object</span>&gt;</span>, 国际化资源.</span><br><span class="line"></span><br><span class="line">IntlProvider 有三个配置参数：</span><br><span class="line">  locale, <span class="tag">&lt;<span class="title">string</span>&gt;</span>, 语言标记，例如 'zh-CN' 'en-US'</span><br><span class="line">  messages, <span class="tag">&lt;<span class="title">object</span>&gt;</span>, 国际化所需的 key-value 对象</span><br><span class="line">  formats, <span class="tag">&lt;<span class="title">object</span>&gt;</span>, 自定义 format，比如日期格式、货币等</span></span><br></pre></td></tr></table></figure>
<p>在定义好 <code>IntlProvider</code> 之后，我们就可以在页面使用它提供的 api 或者组件来进行国际化了。</p>
<h3 id="6-__u4F7F_u7528_react-intl_u2019s_components__26amp_3B_apis"><a href="#6-__u4F7F_u7528_react-intl_u2019s_components__26amp_3B_apis" class="headerlink" title="6. 使用 react-intl’s components &amp; apis"></a>6. 使用 react-intl’s components &amp; apis</h3><p>react-intl 提供了丰富的组件和 api 来完成页面部分的国际化。</p>
<h4 id="u5B57_u7B26_u4E32_u7684_u683C_u5F0F_u5316"><a href="#u5B57_u7B26_u4E32_u7684_u683C_u5F0F_u5316" class="headerlink" title="字符串的格式化"></a>字符串的格式化</h4><p>a. <code>&lt;FormattedMessage /&gt;</code> 这个组件用于格式化字符串，是所有的组件中使用频率最高的组件。除了可以根据配置输出不同语言的简单字符串之外，还可以输出包含动态变化的参数的复杂字符串，具体的用法在后面的例子中会慢慢叙述。</p>
<p>比如我们在 *.message.js 配置文件中写了如下内容：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="string">'page.localeProvider.react'</span>: <span class="string">'&#123; name &#125;, a JavaScript library for building user interfaces.'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>使用这个组件的时候，我们这么写：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedMessage</span><br><span class="line">  tagName=<span class="string">"p"</span></span><br><span class="line">  id=<span class="string">"page.localeProvider.react"</span></span><br><span class="line">  values=&#123;&#123;</span><br><span class="line">    name: <span class="string">'React'</span>,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  defaultMessage=<span class="string">"&#123;name&#125; 是一个用于构建用户界面的 JAVASCRIPT 库。"</span></span><br><span class="line">  description=<span class="string">"&#123;name&#125; 是什么？"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>id 指代的是这个字符串在配置文件中的属性名</li>
<li>description 指的是对于这个位置替代的字符串的描述，便于维护代码，不写的话也不会影响输出的结果</li>
<li>defaultMessage 当在locale配置文件中没有找到这个id的时候，输出的默认值</li>
<li>tagName 实际生成的标签，默认是 <code>span</code></li>
<li>values 动态参数. 格式为对象</li>
</ul>
<p>输出的结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>React, a JavaScript library for building user interfaces.<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>b. <code>&lt;FormattedHTMLMessage /&gt;</code> 这个组件的用法和<formattedmessage>完全相同，唯一的不同就是输出的字符串可以包含HTML标签。</formattedmessage></p>
<h4 id="u65E5_u671F_u65F6_u95F4"><a href="#u65E5_u671F_u65F6_u95F4" class="headerlink" title="日期时间"></a>日期时间</h4><p>a. <code>&lt;FormattedDate /&gt;</code> 用于格式化日期，能够将一个时间戳格式化成不同语言中的日期格式。</p>
<p>传入时间戳作为参数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedDate </span><br><span class="line">  value=&#123;<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1459832991883</span>)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 英文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>4/5/2016<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>2016/5/4<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>b. <code>&lt;FormattedTime&gt;</code> 用于格式化时间，效果与<code>&lt;FormattedDate /&gt;</code>相似。</p>
<p>传入时间戳作为参数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedTime </span><br><span class="line">  value=&#123;<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1459832991883</span>)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 英文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>1:09 AM<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>上午1:09<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>c. <code>&lt;FormattedRelative /&gt;</code> 通过这个组件可以显示传入组件的某个时间戳和当前时间的关系，比如“10 minutes ago”。</p>
<p>传入时间戳作为参数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedRelative </span><br><span class="line">  value=&#123;<span class="built_in">Date</span>.now()&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 英文 =&gt;&gt; 运行时的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>now<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 英文 =&gt;&gt; 10秒之后的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>10 seconds ago<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 英文 =&gt;&gt; 1分钟之后的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>1 minute ago<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 =&gt;&gt; 运行时的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>现在<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 =&gt;&gt; 10秒之后的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>10秒前<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 =&gt;&gt; 1分钟之后的输出结果： --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>1分钟前<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="u6570_u5B57_u91CF_u8BCD"><a href="#u6570_u5B57_u91CF_u8BCD" class="headerlink" title="数字量词"></a>数字量词</h4><p>a. <code>&lt;FormattedPlural /&gt;</code> 这个组件可用于格式化量词，在中文的语境中，其实不太会用得到，比如我们说一个鸡腿，那么量词就是‘个’，我们说两个鸡腿，量词还是‘个’，不会发生变化。但是在英文的语言环境中，描述一个苹果的时候，量词是apple，当苹果数量为两个时，就会变成apples，这个组件的作用就在于此。</p>
<p>传入组件的参数中，value为数量，其他的为不同数量时对应的量词，在下面的例子中，一个的时候量词为message，两个的时候量词为messages。实际上可以传入组件的量词包括 zero, one, two, few, many, other 已经涵盖了所有的情况。</p>
<p>结合 <code>&lt;FormattedMessage /&gt;</code>运用：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> unreadCount = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> unreadCount2 = <span class="number">1</span>;</span><br><span class="line">... </span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="title">FormattedMessage</span></span><br><span class="line">    <span class="attribute">id</span>=<span class="value">"page.localeProvider.unreadCount"</span></span><br><span class="line">    <span class="attribute">defaultMessage</span>=<span class="value">&#123;'你有&#123;</span> <span class="attribute">unreadCount</span> &#125;条新信息'&#125;</span><br><span class="line">    <span class="attribute">values</span>=<span class="value">&#123;&#123;</span></span><br><span class="line">      <span class="attribute">unreadCount:</span> (</span><br><span class="line">        &lt;<span class="attribute">strong</span></span><br><span class="line">          <span class="attribute">style</span>=<span class="value">&#123;&#123;</span></span><br><span class="line">            <span class="attribute">color:</span> '#<span class="attribute">f30</span>',</span><br><span class="line">            <span class="attribute">fontWeight:</span> '<span class="attribute">normal</span>',</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">FormattedNumber</span></span><br><span class="line">            <span class="attribute">value</span>=<span class="value">&#123;unreadCount&#125;</span></span><br><span class="line">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">strong</span>&gt;</span></span><br><span class="line">      )</span>,</span><br><span class="line">      notifications: (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="title">FormattedPlural</span></span><br><span class="line">          <span class="attribute">value</span>=<span class="value">&#123;unreadCount&#125;</span></span><br><span class="line">          <span class="attribute">one</span>=<span class="value">"notification"</span></span><br><span class="line">          <span class="attribute">other</span>=<span class="value">"notifications"</span></span><br><span class="line">        /&gt;</span></span><br><span class="line">      )</span>,</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  /&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">FormattedMessage</span></span><br><span class="line">    <span class="attribute">id</span>=<span class="value">"page.localeProvider.unreadCount"</span></span><br><span class="line">    <span class="attribute">defaultMessage</span>=<span class="value">&#123;'你有&#123;</span> <span class="attribute">unreadCount2</span> &#125;条新信息'&#125;</span><br><span class="line">    <span class="attribute">values</span>=<span class="value">&#123;&#123;</span></span><br><span class="line">      <span class="attribute">unreadCount:</span> (</span><br><span class="line">        &lt;<span class="attribute">strong</span></span><br><span class="line">          <span class="attribute">style</span>=<span class="value">&#123;&#123;</span></span><br><span class="line">            <span class="attribute">color:</span> '#<span class="attribute">f30</span>',</span><br><span class="line">            <span class="attribute">fontWeight:</span> '<span class="attribute">normal</span>',</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">FormattedNumber</span></span><br><span class="line">            <span class="attribute">value</span>=<span class="value">&#123;unreadCount2&#125;</span></span><br><span class="line">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">strong</span>&gt;</span></span><br><span class="line">      )</span>,</span><br><span class="line">      notifications: (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="title">FormattedPlural</span></span><br><span class="line">          <span class="attribute">value</span>=<span class="value">&#123;unreadCount2&#125;</span></span><br><span class="line">          <span class="attribute">one</span>=<span class="value">"notification"</span></span><br><span class="line">          <span class="attribute">other</span>=<span class="value">"notifications"</span></span><br><span class="line">        /&gt;</span></span><br><span class="line">      )</span>,</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  /&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="title">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 英文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>You have 10 new notifications<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>You have 1 notification<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>你有10条新信息<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span>你有1条新信息<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>b. <code>&lt;FormattedNumber /&gt;</code> 这个组件最主要的用途是用来给一串数字标逗号，比如10000这个数字，在中文的语言环境中应该是1,0000，是每隔4位加一个逗号，而在英语的环境中是10,000，每隔3位加一个逗号。</p>
<p>传入数字作为参数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedNumber </span><br><span class="line">  value=&#123;<span class="number">1000</span>&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>1,000<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>&lt;FormattedNumber /&gt;</code> 输出百分比</p>
<p>传入小数作为参数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;FormattedNumber</span><br><span class="line">  value=&#123;<span class="number">0.5</span>&#125;</span><br><span class="line">  style=<span class="string">"percent"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>50%<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>&lt;FormattedNumber /&gt;</code> 输出货币</p>
<p>传入数字作为参数：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// locale.formats.money.currency 是 /locales/*.js 国际化资源配置的货币信息。中文: 'CNY'; 英文: 'USD'</span></span><br><span class="line"></span><br><span class="line">&lt;FormattedNumber</span><br><span class="line">  value=&#123;<span class="number">123456.78</span>&#125;</span><br><span class="line">  style=<span class="string">"currency"</span></span><br><span class="line">  currency=&#123;locale.formats.money.currency&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 英文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>$123,456.78<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 中文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span>￥123,456.78<span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>注：项目在中文情况下也是每隔3位加一个逗号，具体原因详，如果有知道原因的请告知。</p>
<h2 id="u7EC4_u4EF6_u56FD_u9645_u5316"><a href="#u7EC4_u4EF6_u56FD_u9645_u5316" class="headerlink" title="组件国际化"></a>组件国际化</h2><h3 id="1-__u521B_u5EFA_u83B7_u53D6_u4E0A_u4E0B_u6587_u56FD_u9645_u5316_u8D44_u6E90_u51FD_u6570"><a href="#1-__u521B_u5EFA_u83B7_u53D6_u4E0A_u4E0B_u6587_u56FD_u9645_u5316_u8D44_u6E90_u51FD_u6570" class="headerlink" title="1. 创建获取上下文国际化资源函数"></a>1. 创建获取上下文国际化资源函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 获取 组件的语言配置</span><br><span class="line"> *</span><br><span class="line"> * @param &#123;any&#125; props 属性</span><br><span class="line"> * @param &#123;any&#125; context 上下文</span><br><span class="line"> * @param &#123;any&#125; componentName 组件名. 对应 context.locale.messages 中的 key 值</span><br><span class="line"> * @param &#123;any&#125; getDefaultLocale</span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getComponentLocale</span>(<span class="params">props, context, componentName, getDefaultLocale</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> locale = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果 context 上下文中有多语言配置. 则取 context 上下文中的多语言值.</span></span><br><span class="line">  <span class="comment">// 否则, 取默认值的多语言值.</span></span><br><span class="line">  <span class="keyword">if</span> (context &amp;&amp; context.locale &amp;&amp; context.locale.messages[componentName]) &#123;</span><br><span class="line">    locale = context.locale.messages[componentName];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> defaultLocale = getDefaultLocale();</span><br><span class="line">    locale = defaultLocale.default || defaultLocale;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result = &#123;</span><br><span class="line">    ...locale,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果属性有语言配置项, 则合并.</span></span><br><span class="line">  <span class="keyword">if</span> (props.locale) &#123;</span><br><span class="line">    result = &#123;</span><br><span class="line">      ...result,</span><br><span class="line">      ...props.locale,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (props.locale.lang) &#123;</span><br><span class="line">      result.lang = &#123;</span><br><span class="line">        ...locale.lang,</span><br><span class="line">        ...props.locale.lang,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-__u521B_u5EFA_u56FD_u9645_u5316_u7684_u7EC4_u4EF6"><a href="#2-__u521B_u5EFA_u56FD_u9645_u5316_u7684_u7EC4_u4EF6" class="headerlink" title="2. 创建国际化的组件"></a>2. 创建国际化的组件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> &#123; getComponentLocale &#125; <span class="keyword">from</span> <span class="string">'../_utils/getLocale'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Pagination</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// context 上下文</span></span><br><span class="line">  static contextTypes = &#123;</span><br><span class="line">    locale: PropTypes.object,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> currentlocale = getComponentLocale(<span class="keyword">this</span>.props, <span class="keyword">this</span>.context, <span class="string">'Pagination'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="built_in">require</span>(<span class="string">'./locales/zh-CN'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">className</span>=<span class="value">"pagination"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">className</span>=<span class="value">"pagination__wrapper"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">div</span> <span class="attribute">className</span>=<span class="value">"pagination__button__prev"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">a</span>&gt;</span>&#123;currentlocale.prevText&#125;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">div</span> <span class="attribute">className</span>=<span class="value">"pagination__button__next"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">a</span>&gt;</span>&#123;currentlocale.nextText&#125;<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    )</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u56FD_u9645_u5316_u89C4_u8303_u9644_u5F55"><a href="#u56FD_u9645_u5316_u89C4_u8303_u9644_u5F55" class="headerlink" title="国际化规范附录"></a>国际化规范附录</h2><h3 id="React_Intl__u7F16_u5199_u89C4_u8303"><a href="#React_Intl__u7F16_u5199_u89C4_u8303" class="headerlink" title="React Intl 编写规范"></a>React Intl 编写规范</h3><ol>
<li>必须填写 defaultMessage，并将 defaultMessage 作为中文翻译</li>
<li>id 不得重复</li>
<li>在使用 intl.formatMessage() 时，必须使用 defineMessages，预定义消息</li>
</ol>
<h2 id="u6E90_u7801"><a href="#u6E90_u7801" class="headerlink" title="源码"></a>源码</h2><p>整个项目<a href="https://github.com/sufangyu/react-intl-demo" target="_blank" rel="external">源码</a></p>
<h2 id="u8D44_u6599"><a href="#u8D44_u6599" class="headerlink" title="资料"></a>资料</h2><ul>
<li><a href="https://segmentfault.com/a/1190000005824920" target="_blank" rel="external">API</a></li>
<li><a href="https://github.com/ant-design/intl-example/blob/master/docs/understanding-antd-i18n.md" target="_blank" rel="external">国际化方案</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/NumberFormat" target="_blank" rel="external">Intl.NumberFormat</a></li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2017/08/02/infinite-list 是可回收 DOM 的无限下拉列表插件/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">infinite-list 是可回收 DOM 的无限下拉列表插件</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="react-intl-实现-React-国际化多语言" data-title="react-intl 实现 React 国际化多语言" data-url="http://sufangyu.github.io/2017/12/03/react-intl-实现-React-国际化多语言/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"sufangyu"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>







</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 方雨_Yu的博客
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script src="/js/owl.carousel.min.js"></script>
<script src="/js/custom.js"></script>





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>